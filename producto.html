<!DOCTYPE html>
<html lang="es">
<head>
      <!-- basic -->
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- mobile metas -->
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="viewport" content="initial-scale=1, maximum-scale=1">
      <!-- site metas -->
      <title>@nerediarte</title>
      <meta name="keywords" content="">
      <meta name="description" content="">
      <meta name="author" content="">
      <!-- bootstrap css -->
      <link rel="stylesheet" href="css/bootstrap.min.css">
      <!-- style css -->
      <link rel="stylesheet" href="css/style.css">
      <!-- Responsive-->
      <link rel="stylesheet" href="css/responsive.css">
      <link rel="icon" href="images/avatarPortfolio.png" type="image/png" />
      <!-- Scrollbar Custom CSS -->
      <link rel="stylesheet" href="css/jquery.mCustomScrollbar.min.css">
      <!-- Tweaks for older IEs-->
      <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css" media="screen">
      <!-- fevicon -->
      <!--link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'><text y='16' font-size='16' fill='%234b5745'>N</text></svg>" /-->
      <link rel="stylesheet" href="css/jquery.mCustomScrollbar.min.css">
      <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css" media="screen">
      <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->
</head>
<style>
</style>
<body class="main-layout">
  <!-- end loader -->
  <nav class="navbar navbar-expand-lg menuBar">
    <div class="container-fluid px-2 d-flex align-items-center justify-content-between" style="padding: 15px; height: 75px;">
      <img src="images/avatar.png" alt="Logo" style="height: 50px;" class="d-lg-none d-block" />
      <button class="navbar-toggler lg-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation" style="border:none;background:transparent;">
        <span class="navbar-toggler-icon d-flex align-items-center justify-content-center"><img src="images/menu_icon.png" alt="Menú" style="height: 36px;"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav mx-auto d-flex justify-content-center align-items-center flex-wrap" style="float:none;gap:2.2rem;">
        <li class="nav-item"><a class="fixed-bar nav-link" href="index.html">INICIO</a></li>
        <li class="nav-item"><a class="fixed-bar nav-link" href="shop.html">TIENDA</a></li>
        <li class="nav-item"><a class="fixed-bar nav-link" style="color: #000;" onclick="window.open('./portfolio.pdf');">PORTFOLIO</a></li>
        <li class="nav-item"><div class="fixed-bar nav-link p-0"><button onclick="window.location.replace('index.html')" style="background:transparent;border:none;"><img src="images/avatar.png" alt="#"></button></div></li>
        <li class="nav-item"><a class="fixed-bar nav-link" href="">FINES SOLIDARIOS</a></li>
        <li class="nav-item"><a class="fixed-bar nav-link" href="#customer">NEREDIARTE</a></li>
      </ul>
      </div>
    </div>
  </nav>
  <div id="content">
    <section class="product-section">
      <div class="container-fluid">
        <div class="row">
          <div class="col-md-1 thumbnails">
            <img id="product-image0" class="thumbnail" style="margin-top:0;">
            <img id="product-image1" class="thumbnail">
          </div>
          <div class="col-md-6 main-image">
            <img id="product-image" style="width:100%;">
          </div>
          <div class="col-md-5">
            <div class="titlepage" style="margin-right: 50px;">
              <h2 id="product-title">Producto</h2>
              <span style="margin:0; white-space: nowrap;">
                <h3>€</h3>
                <h3 id="product-price"></h3>
                <h3 style="margin-left: 5px;"> EUR</h3>
              </span>
              <p id="product-subtitle" style="font-weight: 400;"></p>
              <p id="product-description" style="text-align: justify;"></p>
              <p style="margin-top: 10px;">Cada mes incluye:</p>
              <div>
                <ul>
                  <li><p style="margin-top: 2px;" id="product-caract1"></p></li>
                  <li><p style="margin-top: 2px;" id="product-caract2"></p></li>
                  <li><p style="margin-top: 2px;" id="product-caract3"></p></li>
                </ul>
              </div>
            </div>
            <div class="game_box" style="margin-right: 50px;">
              <div id="product-form">
                <div class="form-group">
                  <label for="cantidad">Cantidad:</label>
                  <div class="qty-input">
	                  <button class="qty-count qty-count-minus" data-action="minus" type="button">-</button>
	                  <input class="limited-qty" type="number" id="cantidad" name="nombre" min="0" max="10" value="1">
	                  <button class="qty-count qty-count-add" data-action="add" type="button">+</button>
                  </div>
                  <p>Subtotal: €<span id="subtotal">0</span> EUR</p>
                </div>
                <div class="form-group">
                  <label for="Nombre">Nombre completo:</label>
                  <input type="text" id="nombre" name="nombre" required>
                </div>
                <div class="form-group">
                  <label for="Dirección">Dirección de envío:</label>
                  <input type="text" id="direccion" name="nombre" value="C/, nº, apartamento" required>
                </div>
                <div class="row">
                  <div class="col-md-4">
                    <div class="form-group">
                      <label for="CP">Código postal:</label>
                      <input type="text" id="cp" name="nombre" required>
                    </div>
                  </div>
                  <div class="col-md-8">
                    <div class="form-group">
                      <label for="Localidad">Localidad:</label>
                      <input type="text" id="localidad" name="localidad" required>
                    </div>
                  </div>
                </div>
                <div class="form-group">
                  <label for="envio">Tipo de envío:</label>
                  <label class="checkbox"><input type="checkbox" id="ord" /> Ordinario(+3,70€)</label>
                  <label class="checkbox"><input type="checkbox" id="crf"/> Certificado(+8,48€)</label>
                  <label class="checkbox"><input type="checkbox" id="int"/> Fuera de la Península Ibérica</label>
                </div>
                <div class="form-group">
                  <label for="Comentarios">Comentarios:</label>
                  <input type="text" id="comentario" name="comentario">
                </div>
              </div> <!-- end product-form-->
              <p id="email-error" class="email-error" style="visibility: hidden;">Por favor, completa todos los campos.</p>
              <button id="pedido-btn" onclick="enterEmail()"><img src="images/pedido_button.png"></button>  
              <p class="form-group note">*Recibirás un email en menos de 24h con el diseño final y las instrucciones de pago.</p>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
  <!-- PERSONALIZACION -->
  <div id="personalizacion">
  <section class="greenSection">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <div class="paragraph">
            <h2>¿Quieres un diseño personalizado?</h2>
          </div>
        </div>
      </div>
    </div>
    <img src="images/designprocess.png" class="img_caracteristicas">
  </section>
  <section class="greenSection" style="background-color: #fff;">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <div class="paragraph">
            <h2 style="color: #4b5745;">Cómo trabajo</h2>
            <span class="starSpan"><img src="images/separador.png"></span>
          </div>
        </div>
      </div>
    </div>
    <img src="images/comoTrabajo.png" class="img_caracteristicas" style="padding: 0 600px;">
  </section>
  <section class="formsSection">
    <div class="container-fluid">
      <div class="row">
        <div class="col-md-6">
          <div>
            <h2 style="margin-bottom: 20px;">¿Listo para comenzar a crear?</h2>
            <p>Puedes rellenar el formulario de consulta o enviar un correo electrónico directamente a <a class="correo" href="mailto:nerediarte@gmail.com">nerediarte@gmail.com</a>.</p>
            <p> Me pondré en contacto lo antes posible.</p>
            <p style="font-style: italic; margin-top: 20px;">No olvides revisar tu carpeta de correo no deseado.</p>
          </div>
          
        </div>
        <div class="virgencita"><img src="images/drawDecoI.png"></div>
        <div class="col-md-6">
          <div class="game_box">
            <!--figure><img src="images/contact.png"/></figure-->
            <form action="procesar_formulario.php" method="POST" data-type="contacto">
              <!--div class="form-group">
                <label for="Nombre">Nombre:</label>
                <input type="text" id="nombre" name="nombre" required>
              </div-->
              <div class="form-group">
                <label for="email">Email:</label>
                <input type="email" id="email" name="email" required>
              </div>
              <div class="form-group">
                <label for="mensaje">Mensaje:</label>
                <input type="message" style="height: 150px;" id="mensaje" name="mensaje" rows="4" required>
              </div>
              <div class="send_btn"><button type="submit"><img src="images/send_button.png"></button></div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>
  </div>
  <!-- END PERSONALIZACION -->
  </div>
  <!-- PESTAÑA CORREO ELECTRÓNICO-->
  <div id="email-modal-overlay">
    <div class="email-modal">
      <h3 id="title-mail">Dirección de correo</h3>
      <input type="text" id="mail"> 
        <!--input id="email-input"-->
      <div class="modal-buttons">
        <button class="btn-confirm" id="email-confirm-btn" onclick="procesarInfo()">Confirmar</button>
        <button class="btn-cancel" id="email-cancel-btn">Cancelar</button>
      </div>
    </div>
  </div>
  <!-- END PESTAÑA CORREO -->
  <!-- Javascript files-->
  <script src="js/jquery.min.js"></script>
  <script src="js/popper.min.js"></script>
  <script src="js/bootstrap.bundle.min.js"></script>
  <!-- sidebar -->
  <script src="js/jquery.mCustomScrollbar.concat.min.js"></script>
  <script src="https:cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.js"></script>
  <script src="js/custom.js"></script>
  <script type="text/javascript">
    // Force Bootstrap collapse toggle for navbar toggler
    $(document).ready(function() {
      $('.navbar-toggler').on('click', function() {
        $('#navbarNav').collapse('toggle');
      });
    });
    $(document).ready(function() {
      $("#sidebar").mCustomScrollbar({
        theme: "minimal"
      });
      $('#dismiss, .overlay').on('click', function() {
        $('#sidebar').removeClass('active');
        $('.overlay').removeClass('active');
      });
      $('#sidebarCollapse').on('click', function() {
        $('#sidebar').addClass('active');
        $('.overlay').addClass('active');
        $('.collapse.in').toggleClass('in');
        $('a[aria-expanded=true]').attr('aria-expanded', 'false');
      });
    });
    $(document).ready(function() {
      $(".fancybox").fancybox({
        openEffect: "none",
        closeEffect: "none"
      });
      $(".zoom").hover(function() {
        $(this).addClass('transition');
      }, function() {
         $(this).removeClass('transition');
      });
    });

    const products = {
      calendario: {
        title: "CALENDARIO 2026",
        subtitle: "Calendario de pared A4 horizontal (A3 abierto)",
        description: "Acompaña a María durante todo el año con este calendario ilustrado cada mes con una imagen diferente de Nuestra Madre.",
        caract1: "Santo de cada día.",
        caract2: "Festivos y solemnidades.",
        caract3: "Color litúrgico de cada día.",
        image: "images/calendarioII.png",
        image0: "images/calendarioIII.png",
        price: "10",
      },
      agenda: {
        title: "AGENDA 2026",
        subtitle: "Agenda anual 2026 (Enero-Diciembre) tamaño A5.",
        description: "Con estas agendas no solo podrás planificarte durante todo el curso a la perfección, sino que podrás hacerlo de la mano de Jesús y los apóstoles en una aventura que nos acercará juntos al corazón de Cristo.",
        caract1: "Un evangelio acompañado de una ilustración, una reflexión y un reto.",
        caract2: "Calendario con festivos marcados.",
        caract3: "Planificación semanal con objetivos diarios.",
        image: "images/agendaI.png",
        image0: "images/calendarioIII.png",
        price: "20",
      },
    };
    function getQueryParam(param) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(param);
    }
    const productId = getQueryParam('product');
    if (products[productId]) {
      const product = products[productId];
      document.getElementById('product-title').textContent = product.title;
      document.getElementById('product-subtitle').textContent = product.subtitle;
      document.getElementById('product-description').textContent = product.description;
      document.getElementById('product-caract1').textContent = product.caract1;
      document.getElementById('product-caract2').textContent = product.caract2;
      document.getElementById('product-caract3').textContent = product.caract3;
      document.getElementById('product-image').src = product.image;
      document.getElementById('product-image0').src = product.image0;
      document.getElementById('product-price').textContent = product.price;
      updateSubtotal(1);
    } else {
      document.getElementById('product-title').textContent = "Producto no encontrado";
    }
    // Add click listeners for small images
    document.getElementById('product-image0').addEventListener('click', function() {
      document.getElementById('product-image').src = this.src;
      this.classList.add('clicked');
      setTimeout(() => this.classList.remove('clicked'), 300);
    });
    document.getElementById('product-image1').addEventListener('click', function() {
      document.getElementById('product-image').src = this.src;
      this.classList.add('clicked');
      setTimeout(() => this.classList.remove('clicked'), 300);
    });
    
    
    function updateSubtotal(qty){
      console.log("Qty:", qty);
      const precio = parseFloat(document.getElementById('product-price').textContent);
      console.log("Precio: ", precio);
      const subtotal = (qty * precio).toFixed(2);
      console.log(subtotal);
      document.getElementById('subtotal').textContent = subtotal;
    }
      

    /*QUANTITY INPUT*/
    var QtyInput = (function () {
	    var $qtyInputs = $(".qty-input");

	  if (!$qtyInputs.length) {
		  return;
	  }

	  var $inputs = $qtyInputs.find(".limited-qty");
	  var $countBtn = $qtyInputs.find(".qty-count");
	  var qtyMin = parseInt($inputs.attr("min"));
	  var qtyMax = parseInt($inputs.attr("max"));

	  $inputs.change(function () {
		  var $this = $(this);
		  var $minusBtn = $this.siblings(".qty-count-minus");
		  var $addBtn = $this.siblings(".qty-count-add");
		  var qty = parseInt($this.val());

		  if (isNaN(qty) || qty <= qtyMin) {
			  $this.val(qtyMin);
			  $minusBtn.attr("disabled", true);
		  } else {
			  $minusBtn.attr("disabled", false);
			
			  if(qty >= qtyMax){
				  $this.val(qtyMax);
				  $addBtn.attr('disabled', true);
			  } else {
				  $this.val(qty);
				  $addBtn.attr('disabled', false);
			  }
		  }

      updateSubtotal(qty);
	  });

	  $countBtn.click(function () {
		  var operator = this.dataset.action;
		  var $this = $(this);
		  var $input = $this.siblings(".limited-qty");
		  var qty = parseInt($input.val());

		  if (operator == "add") {
			  qty += 1;
			  if (qty >= qtyMin + 1) {
				  $this.siblings(".qty-count-minus").attr("disabled", false);
			  }

			  if (qty >= qtyMax) {
				  $this.attr("disabled", true);
			  }
		  } else {
			  qty = qty <= qtyMin ? qtyMin : (qty -= 1);
			
			  if (qty == qtyMin) {
				  $this.attr("disabled", true);
			  }

			  if (qty < qtyMax) {
				  $this.siblings(".qty-count-add").attr("disabled", false);
			  }
		  }

		  $input.val(qty);
      updateSubtotal(qty);
	  });


    })();
  
  const perror = document.getElementById('email-error');
  const chk = "false";
  function enterEmail(){
      const overlay = document.getElementById('email-modal-overlay');
      
      const nombre = document.getElementById('nombre');
      const dir = document.getElementById('direccion');
      const cp = document.getElementById('cp');
      const loc = document.getElementById('localidad');
      
      console.log(nombre.value, dir.value, cp.value, loc.value, chk);
      

      if(document.getElementById('ord').checked | document.getElementById('crf').checked | document.getElementById('int').checked)
      {
        chk.textContent = "true";
      }

      if(nombre.value == "" || dir.value == "" || cp.value == "" || loc.value == "" || chk.textContent =="false"){
          if(perror.style.visibility ==  'hidden')
          {
              perror.style.visibility = 'visible';
          }
        return;
      } 
      overlay.style.display = 'flex';
  }
  document.addEventListener('keyup', (e) => {
      if(perror.style.visibility ==  'visible') {
            perror.style.visibility = 'hidden';
        }
  });
  function procesarInfo() {
      //Gererar ID de usuario y guardarlo en localStorage
      const idUsuario = Date.now() + "-" + Math.floor(Math.random()*1000); // ejemplo
      localStorage.setItem("idUsuario", idUsuario);

      const ckb = 'ordinario';
      if(document.getElementById('crf'))
      {
        ckb='certificado';
      } else if (document.getElementById('int')){
        ckb='internacional';
      }
      const modelo = products[productId];


      console.log(idUsuario, nombre, fecha, parroquia, mail, texto, modelo, cantidad);

      if(mail === "") {
        perror.textContent = "Por favor, ingresa tu correo electrónico.";
        document.getElementById('title-mail').appendChild(perror);
        perror.style.visibility = 'visible';
        return;
      }



      const datos = 
      {
        type: "producto",
        idUsuario: idUsuario.toString(),
        email: document.getElementById('mail').value,
        nombre: document.getElementById('nombre').value,
        direccion: document.getElementById('dir').value,
        codigoPostal: document.getElementById('cp').value,
        localidad: document.getElementById('loc').value,
        envio: ckb,
        modelo: modelo,
        cantidad: document.getElementById('limited-qty').value
      };

      document.getElementById('loading').style.display = 'flex';

      fetch("https://script.google.com/macros/s/AKfycbwGP4h4vLOHtv8XDE2vGbZYlgw5kZF4qneIvs_arRXW1YawUBVrTBoxZqsKSMlxCJUl/exec", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(datos),
        mode: "no-cors"
      })
      .then(() => {
        console.log("Formulario enviado correctamente");
        sessionStorage.setItem("datosPedido", JSON.stringify(datos));
        window.location.replace("pedido.html");
      })
      .catch(() => {
        perror.textContent = "Hubo un error al enviar el formulario. Intenta de nuevo.";
        perror.style.visibility = 'visible';
      });
    }
  </script>
</body>
</html>